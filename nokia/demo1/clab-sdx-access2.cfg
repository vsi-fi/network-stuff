    acl {
        acl-filter cpm type ipv4 {
            statistics-per-entry true
            entry 10 {
                description "Accept incoming ICMP unreachable messages"
                match {
                    ipv4 {
                        protocol icmp
                        icmp {
                            type dest-unreachable
                        }
                    }
                }
                action {
                    accept {
                        rate-limit {
                            system-cpu-policer icmp
                        }
                    }
                }
            }
            entry 20 {
                description "Accept incoming ICMP time-exceeded messages"
                match {
                    ipv4 {
                        protocol icmp
                        icmp {
                            type time-exceeded
                        }
                    }
                }
                action {
                    accept {
                        rate-limit {
                            system-cpu-policer icmp
                        }
                    }
                }
            }
            entry 40 {
                description "Accept incoming ICMP echo messages"
                match {
                    ipv4 {
                        protocol icmp
                        icmp {
                            type echo
                        }
                    }
                }
                action {
                    accept {
                        rate-limit {
                            system-cpu-policer icmp
                        }
                    }
                }
            }
            entry 50 {
                description "Accept incoming ICMP echo-reply messages"
                match {
                    ipv4 {
                        protocol icmp
                        icmp {
                            type echo-reply
                        }
                    }
                }
                action {
                    accept {
                        rate-limit {
                            system-cpu-policer icmp
                        }
                    }
                }
            }
            entry 60 {
                description "Accept incoming SSH when the other host initiates the TCP connection"
                match {
                    ipv4 {
                        protocol tcp
                    }
                    transport {
                        destination-port {
                            operator eq
                            value 22
                        }
                    }
                }
                action {
                    accept {
                    }
                }
            }
            entry 70 {
                description "Accept incoming SSH when this router initiates the TCP connection"
                match {
                    ipv4 {
                        protocol tcp
                    }
                    transport {
                        source-port {
                            operator eq
                            value 22
                        }
                    }
                }
                action {
                    accept {
                    }
                }
            }
            entry 88 {
                description "Containerlab-added rule: Accept incoming Telnet when the other host initiates the TCP connection"
                match {
                    ipv4 {
                        protocol tcp
                    }
                    transport {
                        source-port {
                            operator eq
                            value 23
                        }
                    }
                }
                action {
                    accept {
                    }
                }
            }
            entry 98 {
                description "Containerlab-added rule: Accept incoming Telnet when this router initiates the TCP connection"
                match {
                    ipv4 {
                        protocol tcp
                    }
                    transport {
                        destination-port {
                            operator eq
                            value 23
                        }
                    }
                }
                action {
                    accept {
                    }
                }
            }
            entry 100 {
                description "Accept incoming TACACS+ when the other host initiates the TCP connection"
                match {
                    ipv4 {
                        protocol tcp
                    }
                    transport {
                        destination-port {
                            operator eq
                            value 49
                        }
                    }
                }
                action {
                    accept {
                    }
                }
            }
            entry 110 {
                description "Accept incoming TACACS+ when this router initiates the TCP connection"
                match {
                    ipv4 {
                        protocol tcp
                    }
                    transport {
                        source-port {
                            operator eq
                            value 49
                        }
                    }
                }
                action {
                    accept {
                    }
                }
            }
            entry 120 {
                description "Accept incoming DNS response messages"
                match {
                    ipv4 {
                        protocol udp
                    }
                    transport {
                        source-port {
                            operator eq
                            value 53
                        }
                    }
                }
                action {
                    accept {
                    }
                }
            }
            entry 130 {
                description "Accept incoming DHCP messages targeted for BOOTP/DHCP client"
                match {
                    ipv4 {
                        protocol udp
                    }
                    transport {
                        destination-port {
                            operator eq
                            value 68
                        }
                    }
                }
                action {
                    accept {
                    }
                }
            }
            entry 158 {
                description "Containerlab-added rule: Accept incoming HTTP(JSON-RPC) when the other host initiates the TCP connection"
                match {
                    ipv4 {
                        protocol tcp
                    }
                    transport {
                        destination-port {
                            operator eq
                            value 80
                        }
                    }
                }
                action {
                    accept {
                    }
                }
            }
            entry 160 {
                description "Accept incoming HTTP(JSON-RPC) when this router initiates the TCP connection"
                match {
                    ipv4 {
                        protocol tcp
                    }
                    transport {
                        source-port {
                            operator eq
                            value 80
                        }
                    }
                }
                action {
                    accept {
                    }
                }
            }
            entry 170 {
                description "Accept incoming NTP messages from servers"
                match {
                    ipv4 {
                        protocol udp
                    }
                    transport {
                        source-port {
                            operator eq
                            value 123
                        }
                    }
                }
                action {
                    accept {
                    }
                }
            }
            entry 180 {
                description "Accept incoming SNMP GET/GETNEXT messages from servers"
                match {
                    ipv4 {
                        protocol udp
                    }
                    transport {
                        destination-port {
                            operator eq
                            value 161
                        }
                    }
                }
                action {
                    accept {
                    }
                }
            }
            entry 190 {
                description "Accept incoming BGP when the other router initiates the TCP connection"
                match {
                    ipv4 {
                        protocol tcp
                    }
                    transport {
                        destination-port {
                            operator eq
                            value 179
                        }
                    }
                }
                action {
                    accept {
                    }
                }
            }
            entry 200 {
                description "Accept incoming BGP when this router initiates the TCP connection"
                match {
                    ipv4 {
                        protocol tcp
                    }
                    transport {
                        source-port {
                            operator eq
                            value 179
                        }
                    }
                }
                action {
                    accept {
                    }
                }
            }
            entry 210 {
                description "Accept incoming HTTPS(JSON-RPC) when the other host initiates the TCP connection"
                match {
                    ipv4 {
                        protocol tcp
                    }
                    transport {
                        destination-port {
                            operator eq
                            value 443
                        }
                    }
                }
                action {
                    accept {
                    }
                }
            }
            entry 220 {
                description "Accept incoming HTTPS(JSON-RPC) when this router initiates the TCP connection"
                match {
                    ipv4 {
                        protocol tcp
                    }
                    transport {
                        source-port {
                            operator eq
                            value 443
                        }
                    }
                }
                action {
                    accept {
                    }
                }
            }
            entry 230 {
                description "Accept incoming single-hop BFD session messages"
                match {
                    ipv4 {
                        protocol udp
                    }
                    transport {
                        destination-port {
                            operator eq
                            value 3784
                        }
                    }
                }
                action {
                    accept {
                    }
                }
            }
            entry 240 {
                description "Accept incoming multi-hop BFD session messages"
                match {
                    ipv4 {
                        protocol udp
                    }
                    transport {
                        destination-port {
                            operator eq
                            value 4784
                        }
                    }
                }
                action {
                    accept {
                    }
                }
            }
            entry 250 {
                description "Accept incoming uBFD session messages"
                match {
                    ipv4 {
                        protocol udp
                    }
                    transport {
                        destination-port {
                            operator eq
                            value 6784
                        }
                    }
                }
                action {
                    accept {
                    }
                }
            }
            entry 260 {
                description "Accept incoming gRPC messages when the other host initiates the TCP connection"
                match {
                    ipv4 {
                        protocol tcp
                    }
                    transport {
                        destination-port {
                            operator eq
                            value 57400
                        }
                    }
                }
                action {
                    accept {
                    }
                }
            }
            entry 270 {
                description "Accept incoming UDP traceroute messages"
                match {
                    ipv4 {
                        protocol udp
                    }
                    transport {
                        destination-port {
                            range {
                                start 33434
                                end 33464
                            }
                        }
                    }
                }
                action {
                    accept {
                    }
                }
            }
            entry 290 {
                description "Accept incoming OSPF messages"
                match {
                    ipv4 {
                        protocol 89
                    }
                }
                action {
                    accept {
                    }
                }
            }
            entry 300 {
                description "Accept incoming DHCP relay messages targeted for BOOTP/DHCP server"
                match {
                    ipv4 {
                        protocol udp
                    }
                    transport {
                        destination-port {
                            operator eq
                            value 67
                        }
                    }
                }
                action {
                    accept {
                    }
                }
            }
            entry 310 {
                description "Accept ICMP fragment packets"
                match {
                    ipv4 {
                        fragment true
                        protocol icmp
                    }
                }
                action {
                    accept {
                        rate-limit {
                            system-cpu-policer icmp
                        }
                    }
                }
            }
            entry 320 {
                description "Accept incoming LDP packets"
                match {
                    ipv4 {
                        protocol udp
                    }
                    transport {
                        source-port {
                            operator eq
                            value 646
                        }
                    }
                }
                action {
                    accept {
                    }
                }
            }
            entry 330 {
                description "Accept incoming LDP packets with source-port 646"
                match {
                    ipv4 {
                        protocol tcp
                    }
                    transport {
                        source-port {
                            operator eq
                            value 646
                        }
                    }
                }
                action {
                    accept {
                    }
                }
            }
            entry 340 {
                description "Accept incoming LDP packets with destination-port 646"
                match {
                    ipv4 {
                        protocol tcp
                    }
                    transport {
                        destination-port {
                            operator eq
                            value 646
                        }
                    }
                }
                action {
                    accept {
                    }
                }
            }
            entry 358 {
                description "Containerlab-added rule: Accept incoming gRPC over port 57401 for the insecure-mgmt gRPC server"
                match {
                    ipv4 {
                        protocol tcp
                    }
                    transport {
                        destination-port {
                            operator eq
                            value 57401
                        }
                    }
                }
                action {
                    accept {
                    }
                }
            }
            entry 370 {
                description "Accept incoming IGMP packets"
                match {
                    ipv4 {
                        protocol igmp
                    }
                }
                action {
                    accept {
                    }
                }
            }
            entry 380 {
                description "Accept incoming PIM packets"
                match {
                    ipv4 {
                        protocol pim
                    }
                }
                action {
                    accept {
                    }
                }
            }
            entry 390 {
                description "Accept incoming RADIUS AAA packets"
                match {
                    ipv4 {
                        protocol udp
                    }
                    transport {
                        source-port {
                            range {
                                start 1812
                                end 1813
                            }
                        }
                    }
                }
                action {
                    accept {
                    }
                }
            }
            entry 410 {
                description "Accept incoming PTP messages with destination-ports 319 and 320"
                match {
                    ipv4 {
                        protocol udp
                    }
                    transport {
                        destination-port {
                            range {
                                start 319
                                end 320
                            }
                        }
                    }
                }
                action {
                    accept {
                    }
                }
            }
            entry 420 {
                description "Accept incoming PCEP packets with destination-port 4189"
                match {
                    ipv4 {
                        protocol tcp
                    }
                    transport {
                        destination-port {
                            operator eq
                            value 4189
                        }
                    }
                }
                action {
                    accept {
                    }
                }
            }
            entry 430 {
                description "Accept incoming SBFD session messages"
                match {
                    ipv4 {
                        protocol udp
                    }
                    transport {
                        source-port {
                            operator eq
                            value 7784
                        }
                    }
                }
                action {
                    accept {
                    }
                }
            }
            entry 440 {
                description "Accept incoming SBFD session messages"
                match {
                    ipv4 {
                        protocol udp
                    }
                    transport {
                        destination-port {
                            operator eq
                            value 7784
                        }
                    }
                }
                action {
                    accept {
                    }
                }
            }
            entry 450 {
                description "Accept incoming LSP MPLS Echo requests and replies"
                match {
                    ipv4 {
                        protocol udp
                    }
                    transport {
                        source-port {
                            operator eq
                            value 3503
                        }
                    }
                }
                action {
                    accept {
                    }
                }
            }
            entry 460 {
                description "Accept incoming LSP MPLS Echo requests and replies"
                match {
                    ipv4 {
                        protocol udp
                    }
                    transport {
                        destination-port {
                            operator eq
                            value 3503
                        }
                    }
                }
                action {
                    accept {
                    }
                }
            }
            entry 1000 {
                description "Drop all else"
                action {
                    log true
                    drop {
                    }
                }
            }
        }
        acl-filter cpm type ipv6 {
            statistics-per-entry true
            entry 10 {
                description "Accept incoming ICMPv6 unreachable messages"
                match {
                    ipv6 {
                        next-header icmp6
                        icmp6 {
                            type dest-unreachable
                        }
                    }
                }
                action {
                    accept {
                        rate-limit {
                            system-cpu-policer icmp
                        }
                    }
                }
            }
            entry 20 {
                description "Accept incoming ICMPv6 packet-too-big messages"
                match {
                    ipv6 {
                        next-header icmp6
                        icmp6 {
                            type packet-too-big
                        }
                    }
                }
                action {
                    accept {
                        rate-limit {
                            system-cpu-policer icmp
                        }
                    }
                }
            }
            entry 30 {
                description "Accept incoming ICMPv6 time-exceeded messages"
                match {
                    ipv6 {
                        next-header icmp6
                        icmp6 {
                            type time-exceeded
                        }
                    }
                }
                action {
                    accept {
                        rate-limit {
                            system-cpu-policer icmp
                        }
                    }
                }
            }
            entry 50 {
                description "Accept incoming ICMPv6 echo-request messages"
                match {
                    ipv6 {
                        next-header icmp6
                        icmp6 {
                            type echo-request
                        }
                    }
                }
                action {
                    accept {
                        rate-limit {
                            system-cpu-policer icmp
                        }
                    }
                }
            }
            entry 60 {
                description "Accept incoming ICMPv6 echo-reply messages"
                match {
                    ipv6 {
                        next-header icmp6
                        icmp6 {
                            type echo-reply
                        }
                    }
                }
                action {
                    accept {
                        rate-limit {
                            system-cpu-policer icmp
                        }
                    }
                }
            }
            entry 70 {
                description "Accept incoming ICMPv6 router-advertisement messages"
                match {
                    ipv6 {
                        next-header icmp6
                        icmp6 {
                            type router-advertise
                        }
                    }
                }
                action {
                    accept {
                        rate-limit {
                            system-cpu-policer icmp
                        }
                    }
                }
            }
            entry 80 {
                description "Accept incoming ICMPv6 neighbor-solicitation messages"
                match {
                    ipv6 {
                        next-header icmp6
                        icmp6 {
                            type neighbor-solicit
                        }
                    }
                }
                action {
                    accept {
                        rate-limit {
                            system-cpu-policer icmp
                        }
                    }
                }
            }
            entry 90 {
                description "Accept incoming ICMPv6 neighbor-advertisement messages"
                match {
                    ipv6 {
                        next-header icmp6
                        icmp6 {
                            type neighbor-advertise
                        }
                    }
                }
                action {
                    accept {
                        rate-limit {
                            system-cpu-policer icmp
                        }
                    }
                }
            }
            entry 100 {
                description "Accept incoming SSH when the other host initiates the TCP connection"
                match {
                    ipv6 {
                        next-header tcp
                    }
                    transport {
                        destination-port {
                            operator eq
                            value 22
                        }
                    }
                }
                action {
                    accept {
                    }
                }
            }
            entry 110 {
                description "Accept incoming SSH when this router initiates the TCP connection"
                match {
                    ipv6 {
                        next-header tcp
                    }
                    transport {
                        source-port {
                            operator eq
                            value 22
                        }
                    }
                }
                action {
                    accept {
                    }
                }
            }
            entry 128 {
                description "Containerlab-added rule: Accept incoming Telnet when the other host initiates the TCP connection"
                match {
                    ipv6 {
                        next-header tcp
                    }
                    transport {
                        source-port {
                            operator eq
                            value 23
                        }
                    }
                }
                action {
                    accept {
                    }
                }
            }
            entry 138 {
                description "Containerlab-added rule: Accept incoming Telnet when this router initiates the TCP connection"
                match {
                    ipv6 {
                        next-header tcp
                    }
                    transport {
                        destination-port {
                            operator eq
                            value 23
                        }
                    }
                }
                action {
                    accept {
                    }
                }
            }
            entry 140 {
                description "Accept incoming TACACS+ when the other host initiates the TCP connection"
                match {
                    ipv6 {
                        next-header tcp
                    }
                    transport {
                        destination-port {
                            operator eq
                            value 49
                        }
                    }
                }
                action {
                    accept {
                    }
                }
            }
            entry 150 {
                description "Accept incoming TACACS+ when this router initiates the TCP connection"
                match {
                    ipv6 {
                        next-header tcp
                    }
                    transport {
                        source-port {
                            operator eq
                            value 49
                        }
                    }
                }
                action {
                    accept {
                    }
                }
            }
            entry 160 {
                description "Accept incoming DNS response messages"
                match {
                    ipv6 {
                        next-header udp
                    }
                    transport {
                        source-port {
                            operator eq
                            value 53
                        }
                    }
                }
                action {
                    accept {
                    }
                }
            }
            entry 188 {
                description "Containerlab-added rule: Accept incoming HTTP(JSON-RPC) when the other host initiates the TCP connection"
                match {
                    ipv6 {
                        next-header tcp
                    }
                    transport {
                        destination-port {
                            operator eq
                            value 80
                        }
                    }
                }
                action {
                    accept {
                    }
                }
            }
            entry 190 {
                description "Accept incoming HTTP(JSON-RPC) when this router initiates the TCP connection"
                match {
                    ipv6 {
                        next-header tcp
                    }
                    transport {
                        source-port {
                            operator eq
                            value 80
                        }
                    }
                }
                action {
                    accept {
                    }
                }
            }
            entry 200 {
                description "Accept incoming NTP messages from servers"
                match {
                    ipv6 {
                        next-header udp
                    }
                    transport {
                        source-port {
                            operator eq
                            value 123
                        }
                    }
                }
                action {
                    accept {
                    }
                }
            }
            entry 210 {
                description "Accept incoming SNMP GET/GETNEXT messages from servers"
                match {
                    ipv6 {
                        next-header udp
                    }
                    transport {
                        destination-port {
                            operator eq
                            value 161
                        }
                    }
                }
                action {
                    accept {
                    }
                }
            }
            entry 220 {
                description "Accept incoming BGP when the other router initiates the TCP connection"
                match {
                    ipv6 {
                        next-header tcp
                    }
                    transport {
                        destination-port {
                            operator eq
                            value 179
                        }
                    }
                }
                action {
                    accept {
                    }
                }
            }
            entry 230 {
                description "Accept incoming BGP when this router initiates the TCP connection"
                match {
                    ipv6 {
                        next-header tcp
                    }
                    transport {
                        source-port {
                            operator eq
                            value 179
                        }
                    }
                }
                action {
                    accept {
                    }
                }
            }
            entry 240 {
                description "Accept incoming HTTPS(JSON-RPC) when the other host initiates the TCP connection"
                match {
                    ipv6 {
                        next-header tcp
                    }
                    transport {
                        destination-port {
                            operator eq
                            value 443
                        }
                    }
                }
                action {
                    accept {
                    }
                }
            }
            entry 250 {
                description "Accept incoming HTTPS(JSON-RPC) when this router initiates the TCP connection"
                match {
                    ipv6 {
                        next-header tcp
                    }
                    transport {
                        source-port {
                            operator eq
                            value 443
                        }
                    }
                }
                action {
                    accept {
                    }
                }
            }
            entry 260 {
                description "Accept incoming DHCPv6 client messages"
                match {
                    ipv6 {
                        next-header udp
                    }
                    transport {
                        destination-port {
                            operator eq
                            value 546
                        }
                    }
                }
                action {
                    accept {
                    }
                }
            }
            entry 270 {
                description "Accept incoming single-hop BFD session messages"
                match {
                    ipv6 {
                        next-header udp
                    }
                    transport {
                        destination-port {
                            operator eq
                            value 3784
                        }
                    }
                }
                action {
                    accept {
                    }
                }
            }
            entry 280 {
                description "Accept incoming multi-hop BFD session messages"
                match {
                    ipv6 {
                        next-header udp
                    }
                    transport {
                        destination-port {
                            operator eq
                            value 4784
                        }
                    }
                }
                action {
                    accept {
                    }
                }
            }
            entry 290 {
                description "Accept incoming uBFD session messages"
                match {
                    ipv6 {
                        next-header udp
                    }
                    transport {
                        destination-port {
                            operator eq
                            value 6784
                        }
                    }
                }
                action {
                    accept {
                    }
                }
            }
            entry 300 {
                description "Accept incoming gRPC messages when the other host initiates the TCP connection"
                match {
                    ipv6 {
                        next-header tcp
                    }
                    transport {
                        destination-port {
                            operator eq
                            value 57400
                        }
                    }
                }
                action {
                    accept {
                    }
                }
            }
            entry 310 {
                description "Accept incoming UDP traceroute messages"
                match {
                    ipv6 {
                        next-header udp
                    }
                    transport {
                        destination-port {
                            range {
                                start 33434
                                end 33464
                            }
                        }
                    }
                }
                action {
                    accept {
                    }
                }
            }
            entry 320 {
                description "Accept incoming IPV6 hop-in-hop messages"
                match {
                    ipv6 {
                        next-header 0
                    }
                }
                action {
                    accept {
                    }
                }
            }
            entry 340 {
                description "Accept incoming OSPF messages"
                match {
                    ipv6 {
                        next-header 89
                    }
                }
                action {
                    accept {
                    }
                }
            }
            entry 350 {
                description "Accept incoming DHCPv6 relay messages"
                match {
                    ipv6 {
                        next-header udp
                    }
                    transport {
                        destination-port {
                            operator eq
                            value 547
                        }
                    }
                }
                action {
                    accept {
                    }
                }
            }
            entry 368 {
                description "Containerlab-added rule: Accept incoming gRPC over port 57401 for the insecure-mgmt gRPC server"
                match {
                    ipv6 {
                        next-header tcp
                    }
                    transport {
                        destination-port {
                            operator eq
                            value 57401
                        }
                    }
                }
                action {
                    accept {
                    }
                }
            }
            entry 380 {
                description "Accept incoming MLDv1 report messages"
                match {
                    ipv6 {
                        next-header icmp6
                        icmp6 {
                            type mld-report
                        }
                    }
                }
                action {
                    accept {
                    }
                }
            }
            entry 390 {
                description "Accept incoming MLDv2 report messages"
                match {
                    ipv6 {
                        next-header icmp6
                        icmp6 {
                            type mld-v2
                        }
                    }
                }
                action {
                    accept {
                    }
                }
            }
            entry 400 {
                description "Accept incoming MLDv1 done messages"
                match {
                    ipv6 {
                        next-header icmp6
                        icmp6 {
                            type mld-done
                        }
                    }
                }
                action {
                    accept {
                    }
                }
            }
            entry 410 {
                description "Accept incoming MLD query messages"
                match {
                    ipv6 {
                        next-header icmp6
                        icmp6 {
                            type mld-query
                        }
                    }
                }
                action {
                    accept {
                    }
                }
            }
            entry 420 {
                description "Accept incoming PIM messages"
                match {
                    ipv6 {
                        next-header pim
                    }
                }
                action {
                    accept {
                    }
                }
            }
            entry 430 {
                description "Accept incoming RADIUS AAA messages"
                match {
                    ipv6 {
                        next-header udp
                    }
                    transport {
                        source-port {
                            range {
                                start 1812
                                end 1813
                            }
                        }
                    }
                }
                action {
                    accept {
                    }
                }
            }
            entry 450 {
                description "Accept incoming PTP messages with destination-ports 319 and 320"
                match {
                    ipv6 {
                        next-header udp
                    }
                    transport {
                        destination-port {
                            range {
                                start 319
                                end 320
                            }
                        }
                    }
                }
                action {
                    accept {
                    }
                }
            }
            entry 460 {
                description "Accept incoming PCEP packets with destination-port 4189"
                match {
                    ipv6 {
                        next-header tcp
                    }
                    transport {
                        destination-port {
                            operator eq
                            value 4189
                        }
                    }
                }
                action {
                    accept {
                    }
                }
            }
            entry 470 {
                description "Accept incoming SBFD session messages"
                match {
                    ipv6 {
                        next-header udp
                    }
                    transport {
                        source-port {
                            operator eq
                            value 7784
                        }
                    }
                }
                action {
                    accept {
                    }
                }
            }
            entry 480 {
                description "Accept incoming SBFD session messages"
                match {
                    ipv6 {
                        next-header udp
                    }
                    transport {
                        destination-port {
                            operator eq
                            value 7784
                        }
                    }
                }
                action {
                    accept {
                    }
                }
            }
            entry 490 {
                description "Accept incoming LDP packets"
                match {
                    ipv6 {
                        next-header udp
                    }
                    transport {
                        source-port {
                            operator eq
                            value 646
                        }
                    }
                }
                action {
                    accept {
                    }
                }
            }
            entry 500 {
                description "Accept incoming LDP packets with source-port 646"
                match {
                    ipv6 {
                        next-header tcp
                    }
                    transport {
                        source-port {
                            operator eq
                            value 646
                        }
                    }
                }
                action {
                    accept {
                    }
                }
            }
            entry 510 {
                description "Accept incoming LDP packets with destination-port 646"
                match {
                    ipv6 {
                        next-header tcp
                    }
                    transport {
                        destination-port {
                            operator eq
                            value 646
                        }
                    }
                }
                action {
                    accept {
                    }
                }
            }
            entry 1000 {
                description "Drop all else"
                action {
                    log true
                    drop {
                    }
                }
            }
        }
        policers {
            system-cpu-policer icmp {
                entry-specific false
                peak-packet-rate 1000
                max-packet-burst 1000
            }
        }
    }
    interface ethernet-1/1 {
        admin-state enable
        vlan-tagging true
        subinterface 100 {
            ipv4 {
                admin-state enable
                unnumbered {
                    admin-state enable
                    interface lo100.100
                }
            }
            vlan {
                encap {
                    single-tagged {
                        vlan-id 100
                    }
                }
            }
        }
    }
    interface ethernet-1/2 {
        admin-state enable
        vlan-tagging true
        subinterface 100 {
            ipv4 {
                admin-state enable
                unnumbered {
                    admin-state enable
                    interface lo100.100
                }
            }
            vlan {
                encap {
                    single-tagged {
                        vlan-id 100
                    }
                }
            }
        }
    }
    interface ethernet-1/3 {
        admin-state enable
        vlan-tagging true
        subinterface 0 {
            type bridged
            admin-state enable
            vlan {
                encap {
                    untagged {
                    }
                }
            }
        }
        subinterface 123 {
            type bridged
            admin-state enable
            vlan {
                encap {
                    single-tagged {
                        vlan-id 123
                    }
                }
            }
        }
    }
    interface irb0 {
        subinterface 123 {
            ipv4 {
                admin-state enable
                address 192.168.123.1/24 {
                }
            }
        }
    }
    interface lo100 {
        subinterface 100 {
            ipv4 {
                admin-state enable
                address 10.10.200.2/32 {
                }
            }
        }
    }
    interface mgmt0 {
        admin-state enable
        subinterface 0 {
            admin-state enable
            ip-mtu 1500
            ipv4 {
                admin-state enable
                dhcp-client {
                }
            }
            ipv6 {
                admin-state enable
                dhcp-client {
                }
            }
        }
    }
    system {
        control-plane-traffic {
            input {
                acl {
                    acl-filter cpm type ipv4 {
                    }
                    acl-filter cpm type ipv6 {
                    }
                }
            }
        }
        aaa {
            authentication {
                idle-timeout 7200
                authentication-method [
                    local
                ]
                admin-user {
                    ssh-key [
                        "ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIJhOmP5ewvgkzyN3FQK/dyaXrLA8vOcC6CC5qPgRyJds"
                    ]
                }
                linuxadmin-user {
                    password $y$j9T$izHOlS9C/VwY75C9kbd7q1$0qQLa41eToEZMkTVkfx0BGEX5bVA1w3na8lPm/JT0LD
                    ssh-key [
                        "ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIJhOmP5ewvgkzyN3FQK/dyaXrLA8vOcC6CC5qPgRyJds"
                    ]
                }
            }
            server-group local {
                type local
            }
        }
        ssh-server mgmt {
            admin-state enable
            network-instance mgmt
            use-credentialz true
        }
        lldp {
            admin-state enable
        }
        grpc-server insecure-mgmt {
            admin-state enable
            rate-limit 65000
            network-instance mgmt
            port 57401
            trace-options [
                request
                response
                common
            ]
            services [
                gnmi
                gnoi
                gribi
                p4rt
            ]
            unix-socket {
                admin-state enable
            }
        }
        grpc-server mgmt {
            admin-state enable
            rate-limit 65000
            tls-profile clab-profile
            network-instance mgmt
            trace-options [
                request
                response
                common
            ]
            services [
                gnmi
                gnoi
                gribi
                p4rt
            ]
            unix-socket {
                admin-state enable
            }
        }
        tls {
            server-profile clab-profile {
                key $aes1$ATAmtvAs/EB+KG8=$saUY/ZlZAmhbFz4QmFRPhmBaiHqZfBvWG1xE9u+EvzxakQTfA82ZymjtdoWru0yMIonslprR4Pg+T3tj7YfLPsJYwnXeVDJ/qSFxtCQ13v/Qu9idHuWUb0EgaFEdIAtZia3hFB68qiNW4f9+EBffXFOJ5Q9mJ9hQQK8HUMx6ieyTnqEGxAY/cRM6HOFxmsM57QxLdDV+k2nvF0rlVFjIQSw4w0qNtgBVh07j7nhEh3VulC/RiFsF5kKj48KxNNl+5lMuf3IVzb7YGEhLLZS8Ash+AeWroSEbxI239sRAOr23UzgZrBDB5OUuvFcSvIpKrRV57prnEuvkKCQDLikMYnd83on5kenhfOt3Ry3Bnj8kDW040mRrDrW/vESStzSSGh4nOZc6D0z/SYXzLdIIEqX6r3pcioQsSx7IykEQ8GRCcchcBNLyduZMkM2JIlgKMZyv9IggcupXT9RVh4BvrnmXxY3Hn+d/JEo5g9JUnayz7jidSH/QYG94iaKQEIJwOEsAQu8q8IFIPKPaUrd1Gos3gYkTkJ1seLTs7WF9SJbb93mW5MZ3UtctTnccCVRtxIz09C+rInBCtG6pZQHN8BqdkkJMIWWjoID9yuv6LbSJ38xewEM4tGjd0t7h3eREE73iqnwCZ8l1pgpsfe6eF0vUe1KFQ6N0VJLjcfZSF5u5E3bPddHchXqTbOAOu80iMbyQPaIWQLZqTZVcVXt+do+29yElxXSDnecJD25QiUqRblE4IvJylpHBu8uGqWhxZ5WNOcPr6Bs9U8uNVnh9NSTDSxuWkD5wE9kZIn24/B3MurD83/1kEIhDhTVSTZOPhmlA3muWinhD/MTIFaN6vCc94xc4+1cxr3LF2E5s+VwkexriYiW/eQljDhkDZDH5V/cZgg94bQGVA/HB5uMF1EgZfPxy+/HtLdSyn50b51wDkXTPD+l5KSG0qZsRORvQljXYjWsZSflxt7xUHAcg4Gm/58/8UYDikTFXfA+zs5apvlZQPPWcrWsIXTda7Mw8hbZl3iylEAu9GNebJn60Zyyx7G+u/alI7aowAKvYv0mWM925LKUqoxOrfrAhuUZgtU2h5lgQoyBACbZ1GzOQpImtES+DzgFfANiW28aw0JQ4dddcIIxXPT4AEkZaYidR/id+PJ6zb14+K2W3xd8nHrQU/Sbnu1K7iQeYfdcfymbSSVgTaz9M+zbbwQVGbZ99PaWNoHcLA91lVlApgU1wKRBUeIElXA79JGamjSIo3xJZAGXTwOdHI8bMcigCIy8hknH80u+/iysZL5wxw9DCaa17Tg8oRzEe5C/0PwtzjA9BNpW1nFyfpVUvJVFXfSx9tocIGS4yte23sVyVCL2pvtYR36dvCgYsT/yQ+nAq3ujdjZ68F3gKt1KDUBN/g1x2i10pZOERWMf5SbwPjv5dIewkk1DtakYdsQVfCmhSsWFvEqiLLPMfZUHsaR0e8RFUXcSxHXO3pSVm2hwfg9Cd0msi9Ot7EV4SbI2G+H4UnV8kkvs4wNhSRm1MqgWLKsSw29ffQta63/ROUQImgn+Kl45QFFRwwofWaHILN4eI2ZMm+HGkiBGQKJBqYlRq61HItRa7OgIQn3pdv/8tPQKdC8M/rbr+VKkbCXdbjc8/bj1kE/6kjLnS4zKr4OaBlTi4lb5NxZNtvJjOzQSJ3l8+OMkLTfPqCQbtBNGPEG1N5nTJcbPhY41F8r12ZcDZMs9Y7wHR03HlWCt6abTTOiVI2xQgkblr2eyJ4Gy4yDf0YFA5BSWLTAFlGYMWArvKG2MXJ6p2g2N82wQO49GydKNWXBtrfCVZeRcjhjDkcjAAuRGVQF9mhcqmxqrFk7WCeenqFtk7GRfL+y2zDonG/388oShtJvUPZmGNwjto+/a5QY4ou9Wz3kn5IpvyeQqYf9OqhhDBwVdLGXqVP2yQYtw+3oaH7VTvuRzBJS0VPVQMaAJajY6k1cjeMld+Krylz2YuPIIZi6+Xr4JXyr2rmlym5z/KAoG1rtWoYUrjg5QTSqvHKIR7nrEDXFQla8IWYnSoDsCCZRAiy+lYzSCvKf0l4C8fkdrEAQdbcBJ0ozDySOXBluB8J4iomf071yn6cv4lzi0EHrPU/1mpqCKMtyRrnxHSgZd95MF9KNWtOgVIugv3CvqXgQySKLit40UsfPqdVUKiUYW6LOErMqqR6O4g/P+/bNgD6QT6GRp79/2W4DqNOObKeYR31UPy/qrckWHy
                certificate "-----BEGIN CERTIFICATE-----
MIID0DCCArigAwIBAgICBnowDQYJKoZIhvcNAQELBQAwTzELMAkGA1UEBhMCVVMx
CTAHBgNVBAcTADEVMBMGA1UEChMMY29udGFpbmVybGFiMQkwBwYDVQQLEwAxEzAR
BgNVBAMTCnNkeCBsYWIgQ0EwHhcNMjQwODI3MDU0MjQ1WhcNMjUwODI3MDU0MjQ1
WjBTMQswCQYDVQQGEwJVUzEJMAcGA1UEBxMAMRUwEwYDVQQKEwxjb250YWluZXJs
YWIxCTAHBgNVBAsTADEXMBUGA1UEAxMOYWNjZXNzMi5zZHguaW8wggEiMA0GCSqG
SIb3DQEBAQUAA4IBDwAwggEKAoIBAQDeOLzyT6JtnCtUvGszOpiAc81/dz7n2pkM
dXG8Ro4aM8JNEwF7hPQUa8wQs+FRXv4F/hnCuNXUrVs+hndeuNPs5HQEiqopgM3+
1QdCEHe1G7EgkXb7hJkhDHF+gYqx+koSDr63GhXyx476uR+Hly30cNvbaB6ICGf3
9IjTzMAs3Duox5sMrkgxD0hIWa4bEBWk+a1+JEK3CFd2f38c34k7K1Bdatg94BB4
8OJEU6Ao8z2U9g23U095RAWnMhTKbk030FKex+oA+Y+omoqxP0PlNjFNHTsnugbP
vQYPqKaDu1ekQ6LNPZ33q8iWMTdbafaoQgIflj1vsYRp3ga0xXmjAgMBAAGjgbEw
ga4wDgYDVR0PAQH/BAQDAgWgMB0GA1UdJQQWMBQGCCsGAQUFBwMCBggrBgEFBQcD
ATAOBgNVHQ4EBwQFAQIDBAYwHwYDVR0jBBgwFoAUSL25lQwNLwXlnkUlwhAINYAJ
ccswTAYDVR0RBEUwQ4IHYWNjZXNzMoIQY2xhYi1zZHgtYWNjZXNzMoIOYWNjZXNz
Mi5zZHguaW+HBKwUFAaHECABAXIAIAAgAAAAAAAAAAYwDQYJKoZIhvcNAQELBQAD
ggEBAIlc3gN6xfDnHqQCLGJKhyWiFVJe+Q254LZuqmBsh1mnQwma0FMCN1Re3fM3
ou46RbR8932QkVaThAnf5FaG1Obo9QBKQwNPKfvuCEL8CQfP5YHy4H/9cq4Sel9B
JoJ6WZQwtVsGo1MkkAjXqAFVh/rYPXih12Ix96DpME6wvT6breNNuoX28FJkoGiL
tGSU5Xxbzv+qO2JNRw5GcyZrhUVAYjK6yLpf/IM4n8hKNpiS0C4QW8AqCCSPYAa7
l8be1bSwNeAfYBbhpBgeI3/RRy7V7hsPexdhLPHOmKb9X3HMIBk7YYnSDh9rkphY
ErLTE6CYFM93I4VwvYPpKXgOqb0=
-----END CERTIFICATE-----
"
                authenticate-client false
            }
        }
        json-rpc-server {
            admin-state enable
            network-instance mgmt {
                http {
                    admin-state enable
                }
                https {
                    admin-state enable
                    tls-profile clab-profile
                }
            }
        }
        dns {
            network-instance mgmt
            server-list [
                192.168.1.1
                2a01:cb15:82:d900:4a29:52ff:fe1e:e80
            ]
        }
        load-balancing {
            hash-options {
                destination-address true
                source-address true
                source-port true
            }
        }
        snmp {
            access-group SNMPv2-RO-Community {
                security-level no-auth-no-priv
                community-entry RO-Community {
                    community $aes1$AWCVHTmWut3kv28=$Zh8guDjTgjjZcgklNOmKmw==
                }
            }
            network-instance mgmt {
                admin-state enable
            }
        }
        banner {
            login-banner "................................................................
:                  Welcome to Nokia SR Linux!                  :
:              Open Network OS for the NetOps era.             :
:                                                              :
:    This is a freely distributed official container image.    :
:                      Use it - Share it                       :
:                                                              :
: Get started: https://learn.srlinux.dev                       :
: Container:   https://go.srlinux.dev/container-image          :
: Docs:        https://doc.srlinux.dev/24-3                    :
: Rel. notes:  https://doc.srlinux.dev/rn24-3-3                :
: YANG:        https://yang.srlinux.dev/release/v24.3.3        :
: Discord:     https://go.srlinux.dev/discord                  :
: Contact:     https://go.srlinux.dev/contact-sales            :
................................................................
"
        }
        logging {
            buffer messages {
                rotate 3
                size 10000000
                facility local6 {
                    priority {
                        match-above informational
                    }
                }
            }
            buffer system {
                facility auth {
                    priority {
                        match-above warning
                    }
                }
                facility cron {
                    priority {
                        match-above warning
                    }
                }
                facility daemon {
                    priority {
                        match-above warning
                    }
                }
                facility ftp {
                    priority {
                        match-above warning
                    }
                }
                facility kern {
                    priority {
                        match-above warning
                    }
                }
                facility lpr {
                    priority {
                        match-above warning
                    }
                }
                facility mail {
                    priority {
                        match-above warning
                    }
                }
                facility news {
                    priority {
                        match-above warning
                    }
                }
                facility syslog {
                    priority {
                        match-above warning
                    }
                }
                facility user {
                    priority {
                        match-above warning
                    }
                }
                facility uucp {
                    priority {
                        match-above warning
                    }
                }
                facility local0 {
                    priority {
                        match-above warning
                    }
                }
                facility local1 {
                    priority {
                        match-above warning
                    }
                }
                facility local2 {
                    priority {
                        match-above warning
                    }
                }
                facility local3 {
                    priority {
                        match-above warning
                    }
                }
                facility local4 {
                    priority {
                        match-above warning
                    }
                }
                facility local5 {
                    priority {
                        match-above warning
                    }
                }
                facility local7 {
                    priority {
                        match-above warning
                    }
                }
            }
            file messages {
                rotate 3
                size 10000000
                facility local6 {
                    priority {
                        match-above warning
                    }
                }
            }
        }
    }
    network-instance VLAN0 {
        type mac-vrf
        admin-state enable
        interface ethernet-1/3.0 {
        }
    }
    network-instance VLAN123 {
        type mac-vrf
        admin-state enable
        interface ethernet-1/3.123 {
        }
        interface irb0.123 {
        }
    }
    network-instance mgmt {
        type ip-vrf
        admin-state enable
        description "Management network instance"
        interface mgmt0.0 {
        }
        protocols {
            linux {
                import-routes true
                export-routes true
                export-neighbors true
            }
        }
    }
    network-instance sdx {
        type ip-vrf
        interface ethernet-1/1.100 {
        }
        interface ethernet-1/2.100 {
        }
        interface irb0.123 {
        }
        interface lo100.100 {
        }
        protocols {
            ospf {
                instance 1 {
                    admin-state enable
                    version ospf-v2
                    router-id 10.10.200.2
                    max-ecmp-paths 8
                    area 0.0.0.0 {
                        interface ethernet-1/1.100 {
                            interface-type point-to-point
                        }
                        interface ethernet-1/2.100 {
                            interface-type point-to-point
                        }
                        interface irb0.123 {
                            passive true
                        }
                        interface lo100.100 {
                            passive true
                        }
                    }
                }
            }
        }
    }
